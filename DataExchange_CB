
Функция TestPOST(Запрос)               
	
	Ответ = Новый HTTPСервисОтвет(200);	
	
	СтрокаXML = СформироватьСтрокуXML();
	
	Ответ.УстановитьТелоИзСтроки(СтрокаXML);
	Возврат Ответ;	
 	
КонецФункции 

Функция СформироватьСтрокуXML()
		
	Узел = ПланыОбмена.ОбменСФИллиалом.НайтиПоКоду("Ф1");
	
	Запись = Новый ЗаписьXML(); 
	Запись.УстановитьСтроку(); 
	Запись.ЗаписатьОбъявлениеXML();  
	
	ЗаписьСообщения = ПланыОбмена.СоздатьЗаписьСообщения();
	ЗаписьСообщения.НачатьЗапись(Запись, Узел);
	Выборка = ПланыОбмена.ВыбратьИзменения(Узел,ЗаписьСообщения.НомерСообщения);
	
	Пока Выборка.Следующий() Цикл	
		
		ОбъектВыборки = Выборка.Получить();		
		ЗаписатьXML(Запись,ОбъектВыборки);
		
	КонецЦикла; 

	ПланыОбмена.УдалитьРегистрациюИзменений(Узел, ЗаписьСообщения.НомерСообщения); 
	
	ЗаписьСообщения.ЗакончитьЗапись();
	Результат = Запись.Закрыть(); 
	
	Возврат Результат;  	

КонецФункции

Функция ОбъектJSON(СтрокаJSON) 

	ЧтениеJSON = Новый ЧтениеJSON;
	ЧтениеJSON.УстановитьСтроку(СтрокаJSON);
	Результат = ПрочитатьJSON(ЧтениеJSON,Истина);
	ЧтениеJSON.Закрыть();
	
	Возврат Результат;
	
КонецФункции // ()
