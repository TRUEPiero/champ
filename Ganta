
&НаКлиенте
Процедура Сформировать(Команда)
	СформироватьНаСервере(ДГ);
КонецПроцедуры

&НаСервереБезКонтекста
Процедура СформироватьНаСервере(ДГ)
	ДГ.Обновление = Ложь;
	ДГ.Очистить();
	
	//ЗаполнитьДанныеОтчетности(ДГ);
	ЗаполнитьГрафикОтпусков(ДГ);
	
	Шкала = ДГ.ОбластьПостроения.ШкалаВремени.Элементы[0];
	Шкала.Метки.Очистить();
	МеткаВремени = Шкала.Метки.Добавить(НачалоДня(ТекущаяДата()));
	МеткаВремени.Текст = "Текущая дата";
	МеткаВремени.ЦветТекста = WebЦвета.Красный;
	МеткаВремени.ЦветЛинии = WebЦвета.Красный;
	
	ДГ.ИнтервалыФона.Очистить();
	
	ДатаНач = НачалоГода(ТекущаяДата());
	Пока ДатаНач <= КонецГода(ТекущаяДата()) Цикл
		Если ДеньНедели(ДатаНач) > 5 Тогда
			ИнтервалФона = ДГ.ИнтервалыФона.Добавить(ДатаНач, КонецДня(ДатаНач));
			ИнтервалФОна.Цвет = WebЦвета.СветлоСерый;
		КонецЕсли;           
		
		ДатаНач = ДатаНач + 86400;
		
	КонецЦикла;
	
	ДГ.Обновление = Истина;
	
КонецПроцедуры 

&НаСервереБезКонтекста
Процедура ЗаполнитьДанныеОтчетности(ДГ)

	ТочкаН = ДГ.УстановитьТочку("Налоговая"); 
	ТочкаН.Картинка = БиблиотекаКартинок.ВложеннаяТаблица;
	
	ТочкаБ = ДГ.УстановитьТочку("Бухгалтерская");
	ТочкаБ.Картинка = БиблиотекаКартинок.ВидРасчета;
	
	Серия = ДГ.УстановитьСерию("Отчетность");
	
	НалоговаяОтчетность = ДГ.ПолучитьЗначение(ТочкаН, Серия);
	БухгалтерскаяОтчетность = ДГ.ПолучитьЗначение(ТочкаБ, Серия);
	
	
    Интервал_КВ1 = НалоговаяОтчетность.Добавить(); 
	Интервал_КВ1.Начало = Дата(2024,03,01);
	Интервал_КВ1.Конец = Дата(2024,03,14);
	Интервал_КВ1.Текст = "Пример текста";
	Интервал_КВ1.Цвет = WebЦвета.Лосось;
		
	Интервал_КВ2 = НалоговаяОтчетность.Добавить(); 
	Интервал_КВ2.Начало = Дата(2024,04,01);
	Интервал_КВ2.Конец = Дата(2024,04,22);
	Интервал_КВ2.Текст = "Пример текста 2";
	Интервал_КВ2.Цвет = WebЦвета.Бирюзовый;
	
	Интервал_КВ1.Добавить(Интервал_КВ2);
	
	Интервал_БКВ1 = БухгалтерскаяОтчетность.Добавить(); 
	Интервал_БКВ1.Начало = Дата(2024,03,14);
	Интервал_БКВ1.Конец = Дата(2024,03,19);
	Интервал_БКВ1.Текст = "Пример текста";
	Интервал_БКВ1.Цвет = WebЦвета.Бежевый;
	
	Интервал_БКВ2 = БухгалтерскаяОтчетность.Добавить(); 
	Интервал_БКВ2.Начало = Дата(2024,04,01);
	Интервал_БКВ2.Конец = Дата(2024,04,22);
	Интервал_БКВ2.Текст = "Пример текста 2";
	Интервал_БКВ2.Цвет = WebЦвета.Бирюзовый;
	
	Интервал_КВ1.Добавить(Интервал_БКВ1);
	
КонецПроцедуры 

&НаСервереБезКонтекста
Процедура ЗаполнитьГрафикОтпусков(ДГ)
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	ГрафикОтпусков.Сотрудник КАК Сотрудник,
		|	ГрафикОтпусков.НачалоОтпуска КАК НачалоОтпуска,
		|	ГрафикОтпусков.КонецОтпуска КАК КонецОтпуска,
		|	ГрафикОтпусков.Сотрудник.Код КАК СотрудникКод
		|ИЗ
		|	РегистрСведений.ГрафикОтпусков КАК ГрафикОтпусков";
	
	РезультатЗапроса = Запрос.Выполнить();
	Выборка = РезультатЗапроса.Выбрать();

	Серия = ДГ.УстановитьСерию("Отпуска");	
	
	Пока Выборка.Следующий() Цикл
		
		Точка = ДГ.УстановитьТочку(Выборка.Сотрудник);		
		Значение = ДГ.ПолучитьЗначение(Точка, Серия);
		Значение.Данные.КодСотрудника = Выборка.СотрудникКод;
		Интервал = Значение.Добавить();
		Интервал.Начало = Выборка.НачалоОтпуска;
		Интервал.Конец = Выборка.КонецОтпуска;
		
	КонецЦикла;
		

КонецПроцедуры
