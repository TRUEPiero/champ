&НаКлиенте
Процедура ТестированиеСправочника(Команда)
	
	ЗапуститьСистему("C:\Program Files (x86)\1cv8t\common\1cestartt.exe /F C:\Users\ingva\OneDrive\Документы\InfoBase10 /TESTCLIENT");	
    ТестовыйСценарий_26_03_2024();
	
КонецПроцедуры

&НаКлиенте
Процедура ТестовыйСценарий_26_03_2024()

	ТестовоеПриложение = Новый ТестируемоеПриложение();
	ВремяОкончанияОжидания = ТекущаяДата() + 60;
	Подключен = Ложь;
	ОписаниеОшибкиСоединения = "";
	Пока Не ТекущаяДата() >= ВремяОкончанияОжидания Цикл
		Попытка
			ТестовоеПриложение.УстановитьСоединение();
			Подключен = Истина;
			Прервать;
		Исключение
			ОписаниеОшибкиСоединения = ОписаниеОшибки();
		КонецПопытки;
	КонецЦикла;
	Если Не Подключен Тогда
		ТестовоеПриложение = Неопределено;
		Сообщить("Не смогли установить соединение! " + Символы.ПС + ОписаниеОшибкиСоединения);
		Возврат;
	КонецЕсли;

	ОкноПриложенияОсновноеКнопкаКомандногоИнтерфейсаСотрудникиНажать(ТестовоеПриложение);
	ОкноПриложенияСотрудникиКнопкаСоздатьНажать(ТестовоеПриложение);
	ОкноПриложенияСотрудникиСозданиеПолеНаименованиеВвестиТекст(ТестовоеПриложение);
	ОкноПриложенияСотрудникиСозданиеКнопкаЗаписатьИЗакрытьНажать(ТестовоеПриложение);

КонецПроцедуры

&НаКлиенте
Процедура ОкноПриложенияОсновноеКнопкаКомандногоИнтерфейсаСотрудникиНажать(ТестовоеПриложение)
	
	ОкноПриложенияОсновное = Неопределено;
	КлиентсткиеОкнаТестируемогоПриложения = ТестовоеПриложение.ПолучитьПодчиненныеОбъекты();
	Для Каждого ТестируемоеОкно Из КлиентсткиеОкнаТестируемогоПриложения Цикл
		Если ТестируемоеОкно.Основное Тогда
			ОкноПриложенияОсновное = ТестируемоеОкно;
			Прервать;
		КонецЕсли;
	КонецЦикла;
	ОкноПриложенияОсновноеCommandInterface = ОкноПриложенияОсновное.ПолучитьКомандныйИнтерфейс();
	КнопкаКомандногоИнтерфейсаСотрудники = ОкноПриложенияОсновноеCommandInterface.НайтиОбъект(Тип("ТестируемаяКнопкаКомандногоИнтерфейса"), "Сотрудники");
	КнопкаКомандногоИнтерфейсаСотрудники.Нажать();

КонецПроцедуры

&НаКлиенте
Процедура ОкноПриложенияСотрудникиКнопкаСоздатьНажать(ТестовоеПриложение)

	ОкноПриложенияСотрудники = ТестовоеПриложение.НайтиОбъект(Тип("ТестируемоеОкноКлиентскогоПриложения"), "Сотрудники", , 30);
	ОкноПриложенияСотрудникиФормаСотрудники = ОкноПриложенияСотрудники.НайтиОбъект(Тип("ТестируемаяФорма"), "Сотрудники");
	КнопкаСоздать = ОкноПриложенияСотрудникиФормаСотрудники.НайтиОбъект(Тип("ТестируемаяКнопкаФормы"), "Создать");
	КнопкаСоздать.Нажать();

КонецПроцедуры

&НаКлиенте
Процедура ОкноПриложенияСотрудникиСозданиеПолеНаименованиеВвестиТекст(ТестовоеПриложение)

	ОкноПриложенияСотрудникиСоздание = ТестовоеПриложение.НайтиОбъект(Тип("ТестируемоеОкноКлиентскогоПриложения"), "Сотрудники (создание)", , 30);
	ОкноПриложенияСотрудникиСозданиеФормаСотрудникиСоздание = ОкноПриложенияСотрудникиСоздание.НайтиОбъект(Тип("ТестируемаяФорма"), "Сотрудники (создание)");
	ПолеНаименование = ОкноПриложенияСотрудникиСозданиеФормаСотрудникиСоздание.НайтиОбъект(Тип("ТестируемоеПолеФормы"), "Наименование");
	ПолеНаименование.ВвестиТекст("Новый тестовый сотрудник");

КонецПроцедуры

&НаКлиенте
Процедура ОкноПриложенияСотрудникиСозданиеКнопкаЗаписатьИЗакрытьНажать(ТестовоеПриложение)

	ОкноПриложенияСотрудникиСоздание = ТестовоеПриложение.НайтиОбъект(Тип("ТестируемоеОкноКлиентскогоПриложения"), "Сотрудники (создание) *", , 30);
	ОкноПриложенияСотрудникиСозданиеФормаСотрудникиСоздание = ОкноПриложенияСотрудникиСоздание.НайтиОбъект(Тип("ТестируемаяФорма"), "Сотрудники (создание) *");
	КнопкаЗаписатьИЗакрыть = ОкноПриложенияСотрудникиСозданиеФормаСотрудникиСоздание.НайтиОбъект(Тип("ТестируемаяКнопкаФормы"), "Записать и закрыть");
	КнопкаЗаписатьИЗакрыть.Нажать();

КонецПроцедуры



